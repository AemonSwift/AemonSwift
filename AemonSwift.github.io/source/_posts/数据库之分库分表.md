---
title: 数据库之分库分表
date: 2019-11-02 07:38:20
tags: 
- 数据库
- 分库分表
categories:
- 数据库
- 分库分表
---
# 为什么要分库分表
就是跟着你的公司业务发展走的，你公司业务发展越好，用户就越多，数据量越大，请求量越大，那你单个数据库一定扛不住。

## 分表(主要为了sql查询速度)
比如你单表都几千万数据了，你确定你能扛住么？绝对不行，单表数据量太大，会极大影响你的 sql 执行的性能，到了后面你的 sql 可能就跑的很慢了。一般来说，就以我的经验来看，单表到几百万的时候，性能就会相对差一些了，你就得分表了。
分表是啥意思？就是把一个表的数据放到多个表中，然后查询的时候你就查一个表。比如按照用户 id 来分表，将一个用户的数据就放在一个表中。然后操作的时候你对一个用户就操作那个表就好了。这样可以控制每个表的数据量在可控的范围内，比如每个表就固定在 200 万以内。

## 分库(主要为了并发度和磁盘使用情况)
分库是啥意思？就是你一个库一般我们经验而言，最多支撑到并发 2000，一定要扩容了，而且一个健康的单库并发值你最好保持在每秒 1000 左右，不要太大。那么你可以将一个库的数据拆分到多个库中，访问的时候就访问一个库好了。
*||
:-:|:-:|:-:
并发支撑情况|MySQL 单机部署，扛不住高并发|	MySQL从单机到多机，能承受的并发增加了多倍
磁盘使用情况|	MySQL 单机磁盘容量几乎撑满|	拆分为多个库，数据库服务器磁盘使用率大大降低
SQL 执行性能|	单表数据量太大，SQL 越跑越慢|	单表数据量减少，SQL 执行效率明显提升